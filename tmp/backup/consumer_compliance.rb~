# == Schema Information
#
# Table name: consumer_compliances
#
#  id                     :integer          not null, primary key
#  consumer_id            :integer
#  consumer_medication_id :integer
#  reminder_triggered_at  :datetime
#  compliance_status      :string(255)
#  reminder_responded_at  :datetime
#  created_at             :datetime
#  updated_at             :datetime
#

class ConsumerCompliance < ActiveRecord::Base
  belongs_to :consumer
  belongs_to :consumer_medication, :inverse_of => :consumer_compliances
  belongs_to :active_consumer_medication, conditions: {  is_active: true } , class_name: 'ConsumerMedication', foreign_key: :consumer_medication_id
  belongs_to :scheduled_reminder
#  has_one    :consumer_drug, through: :consumer_medication, source_type: 'Drug'
#  has_one    :consumer_custom_drug, through: :consumer_medication, source: :consumer_drug, source_type: 'ConsumerCustomDrug'

  scope :of_day, ( lambda do |someday|
  		where( :reminder_triggered_at => (someday)..(someday + 1.day) )
  		# binding.pry
	end )

end
